<!DOCTYPE html>
<html lang="zh-CN">





<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="沧沧凉凉的个人博客，本人是一个前端爱好者，记录平时学习路上遇到的一些困难，同时也是一个游戏爱好者，奈何近期没有出现能提起兴趣的游戏，更是一个科技爱好者，偶尔会分享一些自己觉得有用的知识。博客主要经营：前端知识，游戏排行榜。">
  <meta name="author" content="John Doe">
  <meta name="keywords" content="前端开发,Blog,个人博客网站,博客,html5游戏,JavaScript,JavaScript动画,HTML5,CSS,css3,css3动画,Vue,vuejs,React,reactjs,游戏排行榜,VPS,Linux">
  <meta name="baidu-site-verification" content="aibPQPjuXd" />
  <meta name="google-site-verification" content="2DBVdRMoLMKd9hWPK1TLbao2uPhUNQy4an0NUuBZ7CY" />
  <title>提高处理excal效率的终极神器-VBA初步入门 - 个人博客|沧沧凉凉的小站</title>
  <script data-ad-client="ca-pub-4693483469397315" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />
<link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_fmb4a04yx8h.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_pjno9b9zyxs.css">




<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


<meta name="generator" content="Hexo 4.2.1"></head>


<body>
  <header style="height: 40vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>沧沧凉凉</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">
              <i class="iconfont icon-home-fill"></i>
              首页</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">
              <i class="iconfont icon-archive-fill"></i>
              归档</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/categories/">
              <i class="iconfont icon-category-fill"></i>
              分类</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">
              <i class="iconfont icon-tags-fill"></i>
              标签</a>
          </li>
        
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">
              <i class="iconfont icon-user-fill"></i>
              关于</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/china-5151605_1920.jpg') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <div class="mt-3 post-meta">
                  <i class="iconfont icon-date-fill" aria-hidden="true"></i>
                  <time datetime="2020-06-29 13:01">
                    2020年6月29日 下午
                  </time>
                </div>
              

              <div class="mt-1">
                
                  
                  <span class="post-meta mr-2">
                    <i class="iconfont icon-chart"></i>
                    4.4k 字
                  </span>
                

                
                  
                  <span class="post-meta mr-2">
                      <i class="iconfont icon-clock-fill"></i>
                    
                    
                    56
                     分钟
                  </span>
                

                
              </div>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <div class="post-content mx-auto" id="post">
            
            <article class="markdown-body">
              <h1 id="1-前言"><a href="#1-前言" class="headerlink" title="1. 前言"></a>1. 前言</h1><h2 id="1-1-什么是VBA？"><a href="#1-1-什么是VBA？" class="headerlink" title="1.1 什么是VBA？"></a>1.1 什么是VBA？</h2><p><code>Visual Basic For Application(VBA)</code>可以认为 VBA 是非常流行的应用程序开发语言<code>VASUAL BASIC</code>的子集。实际上VBA是”寄生于”VB应用程序的版本。</p>
<p>也就是说为了自动化需要，微软开发出的一款对于自家的产品（例如：Excal，Word等）的一种通用的自动化语言。也就是说可以帮助人们完成对Excal的一些重复性操作。</p>
<h2 id="1-2-为什么要学习VBA？"><a href="#1-2-为什么要学习VBA？" class="headerlink" title="1.2 为什么要学习VBA？"></a>1.2 为什么要学习VBA？</h2><p>相信不管是什么岗位，在现在这个年代，或多或少都会跟Excal打交道，而VBA比起Excal的公式来说更具有学习成本，但是VBA比Excal的公式更为强大，因为它本身就是一种<strong>脚本语言</strong>。</p>
<h2 id="1-3-VBA能做到什么？"><a href="#1-3-VBA能做到什么？" class="headerlink" title="1.3 VBA能做到什么？"></a>1.3 VBA能做到什么？</h2><p>对于Excal而言你能做到的，它都能做到，同时它能比你完成的更快，更好。如果是重复性的工作交给人来办，多多少少都会有错误，但是你交给VBA来办，只要在你代码编写正确的情况下，就算是再多的数据，它都不可能出错。</p>
<h2 id="1-4-感受VBA"><a href="#1-4-感受VBA" class="headerlink" title="1.4 感受VBA"></a>1.4 感受VBA</h2><p><img src="/image/image-20200629132556351.png" srcset="/img/loading.gif" alt="image-20200629132556351"></p>
<p>这是最近在做的一个游戏数据排行榜，有兴趣的话可以到<a href="https://www.cclliang.com/categories/%E6%B8%B8%E6%88%8F%E6%8E%92%E8%A1%8C%E6%A6%9C/">游戏排行榜</a>进行查看。</p>
<h3 id="1-4-1-需求"><a href="#1-4-1-需求" class="headerlink" title="1.4.1 需求"></a>1.4.1 需求</h3><p>我的需求是右边的数据对比左边的数据，比如说<strong>迷你世界</strong>，右边的数据比左边的数据下降了2个排名，那我就需要在右边的数据中标出<code>↓2</code>并且将它们的文字颜色更改为绿色。</p>
<p>而对于<strong>我的世界</strong>这种排行上升的游戏我也需要在右边的数据中标出<code>↑1</code>并将文字改变成红色。</p>
<p>对于<strong>QQ飞车手游</strong>这种前一天排行榜上面没有的游戏就标记为<code>↑new</code>就跟下面的图一样：</p>
<p><img src="/image/image-20200629133034681.png" srcset="/img/loading.gif" alt="image-20200629133034681"></p>
<p>如果对于你来说，没有学习过VBA那么怎么进行操作？右边对着左边一项一项的比对，然后就行标记？没错，我前2天就是这样，但是后面觉得麻烦，编写了一段VBA代码实现自动化，下面是效果：</p>
<p><img src="/image/sort.gif" srcset="/img/loading.gif" alt=""></p>
<p>可以看到几乎在几秒钟的时间内，就完成了我们一项一项去比对少花费数分钟或者数十分钟的时间，而且自行比对还容易出错。</p>
<h1 id="2-Excel宏命令"><a href="#2-Excel宏命令" class="headerlink" title="2. Excel宏命令"></a>2. Excel宏命令</h1><h2 id="2-1-调出开发工具"><a href="#2-1-调出开发工具" class="headerlink" title="2.1 调出开发工具"></a>2.1 调出开发工具</h2><p>如果你只是要实现简单的自动化，那么使用录制宏功能就可以了。</p>
<p>首先调出<strong>开发工具</strong>，点击<code>文件</code>-<code>选项</code>-<code>自定义功能区</code></p>
<p><img src="/image/image-20200629161719166.png" srcset="/img/loading.gif" alt="image-20200629161719166"></p>
<p>勾选后点击<code>确定</code></p>
<p><img src="/image/image-20200629161849883.png" srcset="/img/loading.gif" alt="image-20200629161849883"></p>
<p>可以看到主界面上出现了一个开发工具。</p>
<p><strong>注：如果是盗版office可能会出现打不开开发工具的情况。</strong></p>
<h2 id="2-2-录制宏"><a href="#2-2-录制宏" class="headerlink" title="2.2 录制宏"></a>2.2 录制宏</h2><p>点击录制宏，会将你所有的动作录制下来，下次再运行宏时会重复你这次录制的操作。</p>
<p><img src="/image/%E5%BD%95%E5%88%B6%E5%AE%8F.gif" srcset="/img/loading.gif" alt=""></p>
<h2 id="2-3-运行宏"><a href="#2-3-运行宏" class="headerlink" title="2.3 运行宏"></a>2.3 运行宏</h2><p><img src="/image/%E8%BF%90%E8%A1%8C%E5%AE%8F.gif" srcset="/img/loading.gif" alt=""></p>
<h2 id="2-4-编辑宏"><a href="#2-4-编辑宏" class="headerlink" title="2.4 编辑宏"></a>2.4 编辑宏</h2><p>编辑宏的方式是在上面的运行宏时，选择<code>编辑</code></p>
<p><img src="/image/image-20200629162624012.png" srcset="/img/loading.gif" alt="image-20200629162624012"></p>
<p>打开后会看到下面的界面</p>
<p><img src="/image/image-20200629162653844.png" srcset="/img/loading.gif" alt="image-20200629162653844"></p>
<h1 id="3-修改宏命令"><a href="#3-修改宏命令" class="headerlink" title="3. 修改宏命令"></a>3. 修改宏命令</h1><p>如果你想用宏实现更为复杂的功能，那就需要学习下面的知识，<strong>上面那仅仅是录制宏，下面开始才是真正的VBA知识。</strong></p>
<h2 id="3-1-标识符"><a href="#3-1-标识符" class="headerlink" title="3.1 标识符"></a>3.1 标识符</h2><p>标识符是一种标识变量、常量、过程、函数、类等语言构成单位的符号，利用它可以完成对变量、常量、过程、函数、类等引用。</p>
<h3 id="3-1-1-命名规则"><a href="#3-1-1-命名规则" class="headerlink" title="3.1.1 命名规则"></a>3.1.1 命名规则</h3><ul>
<li>字母打头，由字母、数字和下划线组成，如<code>A987b_23Abc</code></li>
<li>字符长度小于40，（Excel2002以上中文版本等，可以用汉字且长度可达254个字符）</li>
<li>不能与VB保留字重名，如<code>public，private，dim，goto，next，with，integer，single</code>等</li>
<li>尽量见名知意，比如名字命名为<code>name</code>，而不要命名为<code>n</code>或者其它不知道含义的名字。</li>
</ul>
<h2 id="3-2-运算符"><a href="#3-2-运算符" class="headerlink" title="3.2 运算符"></a>3.2 运算符</h2><ul>
<li>赋值运算符  <code>=</code></li>
<li>数学运算符 <code>&amp;、+ (字符连接符)、+(加)、-（减）、Mod（取余）、\（整除）、*（乘）、/（除）、-（负号）、^（指数）</code></li>
<li>逻辑运算符 <code>Not（非）、And（与）、Or(或)、Xor(异或)、Eqv(相等)、Imp(隐含)</code></li>
<li>关系运算符 <code>= （相同）、&lt;&gt;（不等）、&gt;（大于）、&lt;（小于）、&gt;=（不小于）、&lt;=（不大于）、Like、Is</code></li>
<li>位运算符（不常用）  <code>Not（逻辑非）、And（逻辑与）、Or（逻辑或）、Xor（逻辑异或）、Eqv（逻辑等）、Imp（隐含）</code> </li>
</ul>
<h2 id="3-3-数据类型"><a href="#3-3-数据类型" class="headerlink" title="3.3 数据类型"></a>3.3 数据类型</h2><table>
<thead>
<tr>
<th>数据类型</th>
<th>类型标识符</th>
<th>字节</th>
</tr>
</thead>
<tbody><tr>
<td>String 字符串型</td>
<td>$</td>
<td>字符长度(0-65400)</td>
</tr>
<tr>
<td>Byte 字节型</td>
<td>无</td>
<td>1</td>
</tr>
<tr>
<td>Boolean 布尔型</td>
<td>无</td>
<td>2</td>
</tr>
<tr>
<td>Integer 整数型</td>
<td>%</td>
<td>2</td>
</tr>
<tr>
<td>Long 长整数型</td>
<td>&amp;</td>
<td>4</td>
</tr>
<tr>
<td>Single 单精度型</td>
<td>!</td>
<td>4</td>
</tr>
<tr>
<td>Double 双精度型</td>
<td>#</td>
<td>8</td>
</tr>
<tr>
<td>Date 日期型</td>
<td>无</td>
<td>8 公元 100/1/1-99/12/31</td>
</tr>
<tr>
<td>Currency 货币型</td>
<td>@</td>
<td>8</td>
</tr>
<tr>
<td>Decimal 小数点型</td>
<td>无</td>
<td>14</td>
</tr>
<tr>
<td>Variant 变体型</td>
<td>无</td>
<td>以上任意类型，可变</td>
</tr>
<tr>
<td>Object 对象型</td>
<td>无</td>
<td>4</td>
</tr>
</tbody></table>
<p><strong>PS：这一部分了解就行了，如果不是要做更深入的研究用处不大。</strong></p>
<h2 id="3-4-变量与常量"><a href="#3-4-变量与常量" class="headerlink" title="3.4 变量与常量"></a>3.4 变量与常量</h2><h3 id="3-4-1-未定义变量"><a href="#3-4-1-未定义变量" class="headerlink" title="3.4.1 未定义变量"></a>3.4.1 未定义变量</h3><p><strong>VBA允许使用未定义的变量，默认是变体变量</strong>例如：</p>
<pre><code class="hljs vb"><span class="hljs-keyword">Sub</span> test()

a = <span class="hljs-number">100</span>
MsgBox a

<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span></code></pre>

<h3 id="3-4-2-强制定义变量"><a href="#3-4-2-强制定义变量" class="headerlink" title="3.4.2 强制定义变量"></a>3.4.2 强制定义变量</h3><p><strong>在模块通用说明部分，加入Option Explicit语句可以强迫用户进行变量定义</strong></p>
<h3 id="3-4-3变量定义语句及变量作用域"><a href="#3-4-3变量定义语句及变量作用域" class="headerlink" title="3.4.3变量定义语句及变量作用域"></a>3.4.3变量定义语句及变量作用域</h3><p><code>Dim 变量 as 类型</code>定义为局部变量，如<code>Dim xyz as integer</code> </p>
<p><code>Private 变量 as 类型</code>定义为私有变量，如<code>Private xyz as byte</code> </p>
<p><code>Public 变量as 类型</code>定义为公有变量，如<code>Public xyz as single</code> </p>
<p><code>Global 变量as 类型</code>定义为全局变量，如<code>Globlal xyz as date</code> </p>
<p><code>Static 变量 as 类型</code>定义为静态变量，如<code>Static xyz as double</code></p>
<p>一般变量作用域的原则是，那部分定义就在那部分起作用，模块中定义则在该模块那作用。</p>
<h3 id="3-4-4-常量"><a href="#3-4-4-常量" class="headerlink" title="3.4.4 常量"></a>3.4.4 常量</h3><p>常量为变量的一种特例，用<code>Const</code>定义，且定义时赋值，程序中不能改变值，作用域也如同变量作用域。如下定义：<code>Const Pi As Single = 3.1415926</code></p>
<h2 id="3-5-数组"><a href="#3-5-数组" class="headerlink" title="3.5 数组"></a>3.5 数组</h2><p>数组是包含相同数据类型的一组变量的集合，对数组中的单个变量引用通过数组索引下标进行。在内存中表现为一个连续的内存块，必须用<code>Global</code>或<code>Dim</code>语句来定义。定义规则如下：</p>
<p><code>Dim 数组名([lower to ]upper [, [lower to ]upper, ….]) as type ;Lower</code>缺省值为0。二维数组是按行列排列，如<code>XYZ(行，列)</code>。</p>
<p>除了以上固定数组外，<code>VBA</code> 还有一种功能强大的动态数组，定义时无大小维数声明；在程序中再利用<code>Redim</code>语句来重新改变数组大小，原来数组内容可以通过加<code>preserve</code>关键字来保留。</p>
<h2 id="3-6-注释和赋值语句"><a href="#3-6-注释和赋值语句" class="headerlink" title="3.6 注释和赋值语句"></a>3.6 注释和赋值语句</h2><p>注释语句是用来说明程序中某些语句的功能和作用；</p>
<p>VBA中有两种方法标识为注释语句。</p>
<ul>
<li>单引号 <code>’</code>  ;如：<code>’定义全局变量；</code>可以位于别的语句之尾，也可单独一行</li>
<li><code>Rem</code>如：<code>Rem定义全局变量；</code>只能单独一行</li>
</ul>
<pre><code class="hljs vb"><span class="hljs-keyword">Sub</span> 宏<span class="hljs-number">1</span>()
<span class="hljs-comment">'</span>
<span class="hljs-comment">' 宏1 宏</span>
<span class="hljs-comment">'</span>
<span class="hljs-keyword">Rem</span> 定义全局变量
<span class="hljs-comment">'数学运算符</span>
a = <span class="hljs-number">1</span>
b = <span class="hljs-number">2</span>

<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span></code></pre>

<p>赋值语句是进行对变量或对象属性赋值的语句，采用赋值号 <code>=</code>，如<code>X=123</code>,<code>Form1.caption=”我的窗口”</code></p>
<p>对对象的赋值采用：<code>set myobject=object</code> 或  <code>myobject:=object</code></p>
<h2 id="3-7-书写规范"><a href="#3-7-书写规范" class="headerlink" title="3.7 书写规范"></a>3.7 书写规范</h2><ul>
<li>VBA不区分标识符的字母大小写，一律认为是小写字母；</li>
<li>一行可以书写多条语句，各语句之间以冒号 :  分开；</li>
<li>一条语句可以多行书写，以空格加下划线 <code>_</code> 来标识下行为续行；</li>
<li>标识符最好能简洁明了，不造成歧义。</li>
</ul>
<h2 id="3-8-判断语句"><a href="#3-8-判断语句" class="headerlink" title="3.8 判断语句"></a>3.8 判断语句</h2><h3 id="3-8-1-If…Then…Else语句（最常用）"><a href="#3-8-1-If…Then…Else语句（最常用）" class="headerlink" title="3.8.1 If…Then…Else语句（最常用）"></a>3.8.1 If…Then…Else语句（最常用）</h3><pre><code class="hljs vb"><span class="hljs-keyword">If</span> 条件 <span class="hljs-keyword">Then</span>
表达式
<span class="hljs-keyword">ElseIf</span> 条件 <span class="hljs-keyword">Then</span>
表达式
<span class="hljs-keyword">Else</span>
表达式
<span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>

例如
<span class="hljs-keyword">If</span> Number &lt; <span class="hljs-number">10</span>  <span class="hljs-keyword">Then</span>
     Digits = <span class="hljs-number">1</span>
<span class="hljs-keyword">ElseIf</span> Number &lt; <span class="hljs-number">100</span>  <span class="hljs-keyword">Then</span>
     Digits = <span class="hljs-number">2</span>
<span class="hljs-keyword">Else</span>
     Digits = <span class="hljs-number">3</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span></code></pre>

<h3 id="3-8-2-Select-Case…Case…End-Case语句"><a href="#3-8-2-Select-Case…Case…End-Case语句" class="headerlink" title="3.8.2 Select Case…Case…End Case语句"></a>3.8.2 Select Case…Case…End Case语句</h3><pre><code class="hljs bv">Select Case  Pid
   Case  “A101”
   Price&#x3D;200
   Case  “A102”
   Price&#x3D;300
   ……
   Case Else
   Price&#x3D;900
End Case</code></pre>

<h3 id="3-8-3-Choose-函数"><a href="#3-8-3-Choose-函数" class="headerlink" title="3.8.3 Choose 函数"></a>3.8.3 Choose 函数</h3><p><code>choose(index, choce-1,choice-2,…,choice-n)</code>，可以用来选择自变量串列中的一个值，并将其返回，index 必要参数，数值表达式或字段，它的运算结果是一个数值，且界于 1 和可选择的项目数之间。</p>
<p><code>choice</code> 必要参数，<code>Variant</code>表达式，包含可选择项目的其中之一。如：<code>GetChoice = Choose(Ind, &quot;Speedy&quot;, &quot;United&quot;, &quot;Federal&quot;)</code></p>
<h3 id="3-8-4-Switch函数"><a href="#3-8-4-Switch函数" class="headerlink" title="3.8.4 Switch函数"></a>3.8.4 Switch函数</h3><p><code>Switch(expr-1, value-1[, expr-2, value-2 _ [, expr-n,value-n]])switch</code> 函数和 <code>Choose</code> 函数类似，但它是以两个一组的方式返回所要的值，在串列中，最先为<code>TRUE</code> 的值会被返回。</p>
<p> <code>expr</code> 必要参数，要加以计算的 <code>Variant</code> 表达式。<code>value</code> 必要参数。如果相关的表达式为 <code>True</code>，则返回此部分的数值或表达式，没有一个表达式为 <code>True</code>，<code>Switch</code> 会返回一个 <code>Null</code>值。</p>
<h2 id="3-9-循环语句"><a href="#3-9-循环语句" class="headerlink" title="3.9 循环语句"></a>3.9 循环语句</h2><h3 id="3-9-1For-Next语句"><a href="#3-9-1For-Next语句" class="headerlink" title="3.9.1For Next语句"></a>3.9.1For Next语句</h3><p>以指定次数来重复执行一组语句</p>
<pre><code class="hljs vb"><span class="hljs-keyword">For</span> counter = start <span class="hljs-keyword">To</span> <span class="hljs-keyword">end</span> [<span class="hljs-keyword">Step</span> <span class="hljs-keyword">step</span>]                  ＇<span class="hljs-keyword">step</span> 缺省值为<span class="hljs-number">1</span>
[statements]
[<span class="hljs-keyword">Exit</span> <span class="hljs-keyword">For</span>]
[statements]
<span class="hljs-keyword">Next</span> [counter]

如<span class="hljs-number">1</span>：
<span class="hljs-keyword">For</span> Words = <span class="hljs-number">10</span> <span class="hljs-keyword">To</span> <span class="hljs-number">1</span> <span class="hljs-keyword">Step</span>  <span class="hljs-number">-1</span>                               ＇建立 <span class="hljs-number">10</span> 次循环 
      <span class="hljs-keyword">For</span> Chars = <span class="hljs-number">0</span> <span class="hljs-keyword">To</span> <span class="hljs-number">9</span>                                        ＇建立 <span class="hljs-number">10</span> 次循环
           MyString = MyString &amp; Chars                      ＇将数字添加到字符串中
      <span class="hljs-keyword">Next</span> Chars                                                   ＇Increment counter
      MyString = MyString &amp; <span class="hljs-string">" "</span>                                ＇添加一个空格
<span class="hljs-keyword">Next</span>  Words</code></pre>

<h3 id="3-9-2-For-Each…Next-语句"><a href="#3-9-2-For-Each…Next-语句" class="headerlink" title="3.9.2 For Each…Next 语句"></a>3.9.2 For Each…Next 语句</h3><p>主要功能是对一个数组或集合对象进行，让所有元素重复执行一次语句</p>
<pre><code class="hljs vb"><span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> element <span class="hljs-keyword">In</span>  <span class="hljs-keyword">group</span>
Statements
[<span class="hljs-keyword">Exit</span> <span class="hljs-keyword">for</span>]
Statements
<span class="hljs-keyword">Next</span>  [element]

如<span class="hljs-number">1</span>：
<span class="hljs-keyword">For</span> <span class="hljs-keyword">Each</span> rang2 <span class="hljs-keyword">In</span>  range1
     <span class="hljs-keyword">With</span> range2.interior
             .colorindex=<span class="hljs-number">6</span>
             .pattern=xlSolid
     <span class="hljs-keyword">End</span> <span class="hljs-keyword">with</span>
<span class="hljs-keyword">Next</span></code></pre>

<h3 id="3-9-3-其他循环语句"><a href="#3-9-3-其他循环语句" class="headerlink" title="3.9.3 其他循环语句"></a>3.9.3 其他循环语句</h3><p>因为不介意使用所以这里就不过多介绍了。</p>
<h2 id="3-10-错误语句处理"><a href="#3-10-错误语句处理" class="headerlink" title="3.10 错误语句处理"></a>3.10 错误语句处理</h2><p>执行阶段有时会有错误的情况发生，利用OnError语句来处理错误，启动一个错误的处理程序。</p>
<p>语法如下：</p>
<p><code>On Error Goto Line</code>     当错误发生时，会立刻转移到line行去<br><code>On Error Resume Next</code>   当错误发生时，会立刻转移到发生错误的下一行去<br><code>On Erro Goto 0</code>       当错误发生时，会立刻停止过程中任何错误处理过程</p>
<h2 id="3-11-过程和函数"><a href="#3-11-过程和函数" class="headerlink" title="3.11 过程和函数"></a>3.11 过程和函数</h2><p>过程是构成程序的一个模块，往往用来完成一个相对独立的功能。过程可以使程序更清晰、更具结构性。VBA具有四种过程：Sub 过程、Function函数、Property属性过程和Event事件过程。</p>
<h3 id="3-11-1-Sub过程"><a href="#3-11-1-Sub过程" class="headerlink" title="3.11.1 Sub过程"></a>3.11.1 Sub过程</h3><p>Sub 过程的参数有两种传递方式：按值传递(ByVal)和按地址传递(ByRef)。如下例：</p>
<pre><code class="hljs vb"><span class="hljs-keyword">Sub</span> password (<span class="hljs-keyword">ByVal</span> x <span class="hljs-keyword">as</span> <span class="hljs-built_in">integer</span>, <span class="hljs-keyword">ByRef</span> y <span class="hljs-keyword">as</span> <span class="hljs-built_in">integer</span>)
   <span class="hljs-keyword">If</span> y=<span class="hljs-number">100</span> <span class="hljs-keyword">then</span> y=x+y <span class="hljs-keyword">else</span> y=x-y
   x=x+<span class="hljs-number">100</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">sub</span>
<span class="hljs-keyword">Sub</span> call_password ()
   <span class="hljs-keyword">Dim</span> x1 <span class="hljs-keyword">as</span> <span class="hljs-built_in">integer</span>
   <span class="hljs-keyword">Dim</span> y1 <span class="hljs-keyword">as</span> <span class="hljs-built_in">integer</span>
   x1=<span class="hljs-number">12</span>
   y1=<span class="hljs-number">100</span>
   Callpassword(x1,y1)   ‘调用过程方式：<span class="hljs-number">1.</span><span class="hljs-keyword">Call</span>  过程名(参数<span class="hljs-number">1</span>,  参数<span class="hljs-number">2</span>…);<span class="hljs-number">2.</span>  过程名 参数<span class="hljs-number">1</span>, 参数<span class="hljs-number">2</span>…
   debug.print x1,y1     ‘结果是<span class="hljs-number">12</span>、<span class="hljs-number">112</span>，y1按地址传递改变了值，而x1按值传递，未改变原值
<span class="hljs-keyword">End</span> <span class="hljs-keyword">sub</span></code></pre>

<h3 id="3-11-2-Function函数"><a href="#3-11-2-Function函数" class="headerlink" title="3.11.2 Function函数"></a>3.11.2 Function函数</h3><p>函数实际是实现一种映射，它通过一定的映射规则，完成运算并返回结果。参数传递也两种：按值传递(ByVal)和按地址传递(ByRef)。如下例：</p>
<pre><code class="hljs vb"><span class="hljs-keyword">Function</span> password(<span class="hljs-keyword">ByVal</span> x <span class="hljs-keyword">as</span> <span class="hljs-built_in">integer</span>, <span class="hljs-keyword">byref</span> y <span class="hljs-keyword">as</span> <span class="hljs-built_in">integer</span>) <span class="hljs-keyword">as</span> <span class="hljs-built_in">boolean</span>
    <span class="hljs-keyword">If</span> y=<span class="hljs-number">100</span> <span class="hljs-keyword">then</span> y=x+y <span class="hljs-keyword">else</span> y=x-y
    x=x+<span class="hljs-number">100</span>
    <span class="hljs-keyword">if</span> y=<span class="hljs-number">150</span> <span class="hljs-keyword">then</span> password=<span class="hljs-literal">true</span> <span class="hljs-keyword">else</span> password=<span class="hljs-literal">false</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Function</span>
<span class="hljs-keyword">Sub</span> call_password ()
   <span class="hljs-keyword">Dim</span> x1 <span class="hljs-keyword">as</span> <span class="hljs-built_in">integer</span>
   <span class="hljs-keyword">Dim</span> y1 <span class="hljs-keyword">as</span> <span class="hljs-built_in">integer</span>
   x1=<span class="hljs-number">12</span>
   y1=<span class="hljs-number">100</span>
   <span class="hljs-keyword">if</span> password <span class="hljs-keyword">then</span> ‘调用函数：<span class="hljs-number">1.</span> 作为一个表达式放在=右端 ; <span class="hljs-number">2.</span> 作为参数使用
   debug.print x1
   <span class="hljs-keyword">end</span> <span class="hljs-keyword">if</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">sub</span></code></pre>

<h3 id="3-11-3-Property属性过程和Event事件过程"><a href="#3-11-3-Property属性过程和Event事件过程" class="headerlink" title="3.11.3 Property属性过程和Event事件过程"></a>3.11.3 Property属性过程和Event事件过程</h3><p>这是VB在对象功能上添加的两个过程，与对象特征密切相关，也是VBA比较重要组成，技术比较复杂，可以参考相关书籍。</p>
<h2 id="3-12-内部函数"><a href="#3-12-内部函数" class="headerlink" title="3.12 内部函数"></a>3.12 内部函数</h2><p>在VBA程序语言中有许多内置函数，可以帮助程序代码设计和减少代码的编写工作。</p>
<h3 id="3-12-1-测试函数"><a href="#3-12-1-测试函数" class="headerlink" title="3.12.1 测试函数"></a>3.12.1 测试函数</h3><p><code>IsNumeric(x)</code>      ‘是否为数字,  返回Boolean结果，True  or False</p>
<p><code>IsDate(x)</code>        ‘是否是日期,  返回Boolean结果，True  or False</p>
<p><code>IsEmpty（x）</code>     ‘是否为Empty, 返回Boolean结果，True  or False</p>
<p><code>IsArray(x)</code>       ‘指出变量是否为一个数组。</p>
<p><code>IsError(expression)</code>  ‘指出表达式是否为一个错误值</p>
<p><code>IsNull(expression)</code>   ‘指出表达式是否不包含任何有效数据 (Null)。</p>
<p><code>IsObject(identifier)</code>  ‘指出标识符是否表示对象变量</p>
<h3 id="3-12-2-数学函数"><a href="#3-12-2-数学函数" class="headerlink" title="3.12.2 数学函数"></a>3.12.2 数学函数</h3><p><code>Sin(X)</code>、<code>Cos(X)</code>、<code>Tan(X)</code>、<code>Atan(x)</code>  三角函数，单位为弧度</p>
<p><code>Log(x)</code> 返回x的自然对数</p>
<p><code>Exp(x)</code>返回 <img src="https://atts.w3cschool.cn/attachments/day_161019/201610190955366418.png" srcset="/img/loading.gif" alt="img"></p>
<p><code>Abs(x)</code> 返回绝对值</p>
<p><code>Int(number)</code>、<code>Fix(number)</code> 都返回参数的整数部分，区别：<code>Int</code> 将 -8.4 转换成 -9，而 <code>Fix</code> 将-8.4 转换成 -8</p>
<p><code>Sgn(number)</code> 返回一个 <code>Variant (Integer)</code>，指出参数的正负号</p>
<p><code>Sqr(number)</code> 返回一个 <code>Double</code>，指定参数的平方根</p>
<p><code>VarType(varname)</code> 返回一个 <code>Integer</code>，指出变量的子类型</p>
<p><code>Rnd（x）</code>返回0-1之间的单精度数据，x为随机种子</p>
<h3 id="3-12-3-字符串函数"><a href="#3-12-3-字符串函数" class="headerlink" title="3.12.3 字符串函数"></a>3.12.3 字符串函数</h3><p><code>Trim(string)</code>去掉string左右两端空白</p>
<p><code>Ltrim(string)</code>去掉string左端空白</p>
<p><code>Rtrim(string)</code>去掉string右端空白</p>
<p><code>Len(string)</code>计算string长度</p>
<p><code>Left(string, x)</code>取string左段x个字符组成的字符串</p>
<p><code>Right(string, x)</code>取string右段x个字符组成的字符串</p>
<p><code>Mid(string, start,x)</code>取string从start位开始的x个字符组成的字符串</p>
<p><code>Ucase(string)</code>转换为大写</p>
<p><code>Lcase(string)</code>转换为小写</p>
<p><code>Space(x)</code>返回x个空白的字符串</p>
<p><code>Asc(string)</code>返回一个 integer，代表字符串中首字母的字符代码</p>
<p><code>Chr(charcode)</code>返回 string,其中包含有与指定的字符代码相关的字符</p>
<h3 id="3-12-4-转换函数"><a href="#3-12-4-转换函数" class="headerlink" title="3.12.4 转换函数"></a>3.12.4 转换函数</h3><p><code>CBool(expression)</code>转换为Boolean型</p>
<p><code>CByte(expression)</code>转换为Byte型</p>
<p><code>CCur(expression)</code>转换为Currency型</p>
<p><code>CDate(expression)</code>转换为Date型</p>
<p><code>CDbl(expression)</code>转换为Double型</p>
<p><code>CDec(expression)</code>转换为Decemal型</p>
<p><code>CInt(expression)</code>转换为Integer型</p>
<p><code>CLng(expression)</code>转换为Long型</p>
<p><code>CSng(expression)</code>转换为Single型</p>
<p><code>CStr(expression)</code>转换为String型</p>
<p><code>CVar(expression)</code>转换为Variant型</p>
<p><code>Val(string)</code>转换为数据型</p>
<p><code>Str(number)</code>转换为String</p>
<h3 id="3-12-5-时间函数"><a href="#3-12-5-时间函数" class="headerlink" title="3.12.5 时间函数"></a>3.12.5 时间函数</h3><p><code>Now</code>  返回一个 Variant (Date)，根据计算机系统设置的日期和时间来指定日期和时间。</p>
<p><code>Date</code>返回包含系统日期的 Variant (Date)。</p>
<p><code>Time</code> 返回一个指明当前系统时间的 Variant (Date)。</p>
<p><code>Timer</code> 返回一个 Single，代表从午夜开始到现在经过的秒数。</p>
<p><code>TimeSerial(hour, minute, second)</code> 返回一个 Variant (Date)，包含具有具体时、分、秒的时间。</p>
<p><code>DateDiff(interval, date1, date2[, firstdayofweek[, firstweekofyear]])</code> 返回 Variant(Long) 的值，表示两个指定日期间的时间间隔数目</p>
<p><code>Second(time) 返回一个 Variant (Integer)</code>，其值为 0 到 59 之间的整数，表示一分钟之中的某个秒</p>
<p><code>Minute(time) 返回一个 Variant (Integer)</code>，其值为 0 到 59 之间的整数，表示一小时中的某分钟Hour(time)  返回一个 </p>
<p><code>Variant(Integer)</code>，其值为 0 到 23 之间的整数，表示一天之中的某一钟点</p>
<p><code>Day(date)</code>  返回一个 <code>Variant(Integer)</code>，其值为 1 到 31 之间的整数，表示一个月中的某一日</p>
<p><code>Month(date)</code> 返回一个 <code>Variant(Integer)</code>，其值为 1 到 12 之间的整数，表示一年中的某月</p>
<p><code>Year(date)</code>  返回 <code>Variant (Integer)</code>，包含表示年份的整数。</p>
<p><code>Weekday(date, [firstdayofweek])</code> 返回一个 <code>Variant (Integer)</code>，包含一个整数，代表某个日期是星期几</p>
<h1 id="4-最后"><a href="#4-最后" class="headerlink" title="4. 最后"></a>4. 最后</h1><p>最后给出之前的<code>1.4 感受VBA</code>中我使用到的代码。</p>
<pre><code class="hljs vb"><span class="hljs-keyword">Sub</span> 游戏排行宏()
<span class="hljs-comment">'</span>
<span class="hljs-comment">' 宏2 宏</span>
<span class="hljs-comment">'</span>

<span class="hljs-comment">'核心代码</span>
    <span class="hljs-keyword">For</span> i = <span class="hljs-number">2</span> <span class="hljs-keyword">To</span> <span class="hljs-number">31</span>
    isHave = <span class="hljs-literal">False</span>
     <span class="hljs-keyword">For</span> j = <span class="hljs-number">2</span> <span class="hljs-keyword">To</span> <span class="hljs-number">31</span>
     <span class="hljs-keyword">If</span> Range(<span class="hljs-string">"F"</span> &amp; i) = Range(<span class="hljs-string">"B"</span> &amp; j) <span class="hljs-keyword">Then</span>
     isHave = <span class="hljs-literal">True</span>
     <span class="hljs-keyword">If</span> Range(<span class="hljs-string">"E"</span> &amp; i) - Range(<span class="hljs-string">"A"</span> &amp; j) &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
     Count = Range(<span class="hljs-string">"E"</span> &amp; i) - Range(<span class="hljs-string">"A"</span> &amp; j)
     Range(<span class="hljs-string">"F"</span> &amp; i) = Range(<span class="hljs-string">"F"</span> &amp; i) &amp; <span class="hljs-string">" ↓"</span> &amp; Count
     Range(<span class="hljs-string">"E"</span> &amp; i &amp; <span class="hljs-string">":"</span> &amp; <span class="hljs-string">"G"</span> &amp; i).<span class="hljs-keyword">Select</span>
     <span class="hljs-keyword">With</span> Selection.Font
        .ThemeColor = xlThemeColorAccent6
        .TintAndShade = <span class="hljs-number">0</span>
     <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
     <span class="hljs-keyword">ElseIf</span> Range(<span class="hljs-string">"E"</span> &amp; i) - Range(<span class="hljs-string">"A"</span> &amp; j) &lt; <span class="hljs-number">0</span> <span class="hljs-keyword">Then</span>
     Count = Abs(Range(<span class="hljs-string">"E"</span> &amp; i) - Range(<span class="hljs-string">"A"</span> &amp; j))
     Range(<span class="hljs-string">"F"</span> &amp; i) = Range(<span class="hljs-string">"F"</span> &amp; i) &amp; <span class="hljs-string">" ↑"</span> &amp; Count
     Range(<span class="hljs-string">"E"</span> &amp; i &amp; <span class="hljs-string">":"</span> &amp; <span class="hljs-string">"G"</span> &amp; i).<span class="hljs-keyword">Select</span>
     <span class="hljs-keyword">With</span> Selection.Font
        .Color = <span class="hljs-number">-16776961</span>
        .TintAndShade = <span class="hljs-number">0</span>
     <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
     <span class="hljs-keyword">Exit</span> <span class="hljs-keyword">For</span>
     <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
     <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
     <span class="hljs-keyword">Next</span>
    <span class="hljs-keyword">If</span> isHave = <span class="hljs-literal">False</span> <span class="hljs-keyword">Then</span>
    Range(<span class="hljs-string">"F"</span> &amp; i) = Range(<span class="hljs-string">"F"</span> &amp; i) &amp; <span class="hljs-string">" ↑new"</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">If</span>
    <span class="hljs-keyword">Next</span>
<span class="hljs-comment">' 下面为调整格式，直接通过录制宏拷贝过来的代码</span>
    Columns(<span class="hljs-string">"E:E"</span>).ColumnWidth = <span class="hljs-number">7</span>
    Columns(<span class="hljs-string">"F:F"</span>).ColumnWidth = <span class="hljs-number">50</span>
    Columns(<span class="hljs-string">"G:G"</span>).ColumnWidth = <span class="hljs-number">21.5</span>
    Range(<span class="hljs-string">"E1:G31"</span>).<span class="hljs-keyword">Select</span>
    Range(<span class="hljs-string">"F16"</span>).Activate
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    <span class="hljs-keyword">With</span> Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = <span class="hljs-number">0</span>
        .TintAndShade = <span class="hljs-number">0</span>
        .Weight = xlThin
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
    <span class="hljs-keyword">With</span> Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = <span class="hljs-number">0</span>
        .TintAndShade = <span class="hljs-number">0</span>
        .Weight = xlThin
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
    <span class="hljs-keyword">With</span> Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = <span class="hljs-number">0</span>
        .TintAndShade = <span class="hljs-number">0</span>
        .Weight = xlThin
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
    <span class="hljs-keyword">With</span> Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = <span class="hljs-number">0</span>
        .TintAndShade = <span class="hljs-number">0</span>
        .Weight = xlThin
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
    <span class="hljs-keyword">With</span> Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = <span class="hljs-number">0</span>
        .TintAndShade = <span class="hljs-number">0</span>
        .Weight = xlThin
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
    <span class="hljs-keyword">With</span> Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = <span class="hljs-number">0</span>
        .TintAndShade = <span class="hljs-number">0</span>
        .Weight = xlThin
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
    <span class="hljs-keyword">With</span> Selection.Font
        .Name = <span class="hljs-string">"阿里巴巴普惠体"</span>
        .Size = <span class="hljs-number">11</span>
        .Strikethrough = <span class="hljs-literal">False</span>
        .Superscript = <span class="hljs-literal">False</span>
        .Subscript = <span class="hljs-literal">False</span>
        .OutlineFont = <span class="hljs-literal">False</span>
        .Shadow = <span class="hljs-literal">False</span>
        .Underline = xlUnderlineStyleNone
        .TintAndShade = <span class="hljs-number">0</span>
        .ThemeFont = xlThemeFontNone
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
    Range(<span class="hljs-string">"1:1,3:3,5:5,7:7,9:9"</span>).<span class="hljs-keyword">Select</span>
    Range(<span class="hljs-string">"A9"</span>).Activate
    ActiveWindow.SmallScroll Down:=<span class="hljs-number">6</span>
    Range( _
        <span class="hljs-string">"1:1,3:3,5:5,7:7,9:9,11:11,13:13,15:15,17:17,19:19,21:21,23:23,25:25,27:27,29:29,31:31"</span> _
        ).<span class="hljs-keyword">Select</span>
    Range(<span class="hljs-string">"A31"</span>).Activate
    <span class="hljs-keyword">With</span> Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = <span class="hljs-number">-0.149998474074526</span>
        .PatternTintAndShade = <span class="hljs-number">0</span>
    <span class="hljs-keyword">End</span> <span class="hljs-keyword">With</span>
<span class="hljs-keyword">End</span> <span class="hljs-keyword">Sub</span></code></pre>

<p>其实有个简单的方法，你先将你需要的功能通过<code>录制宏</code>录制下来，再进行编辑这个宏就可以了。</p>
<p>如果上面的知识你都差不多了解了的话，那么VBA就基本上入门了，如果遇到什么无法解决的问题，到时候再通过百度进行学习就可以了。</p>
<h2 id="4-1-参考资料"><a href="#4-1-参考资料" class="headerlink" title="4.1 参考资料"></a>4.1 参考资料</h2><p><a href="https://www.w3cschool.cn/excelvba/excelvba-basics.html" target="_blank" rel="noopener">VBA语言的基础认识</a></p>

            </article>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/Excal/">Excal</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E5%AE%8F%E5%91%BD%E4%BB%A4/">宏命令</a>
                    
                      <a class="hover-with-bg" href="/tags/VBA/">VBA</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" target="_blank" rel="nofollow noopener noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-6">
                    
                    
                  </div>
                  <div class="post-next col-6">
                    
                    
                      <a href="/2020/06/29/%E6%B8%B8%E6%88%8F%E6%8E%92%E8%A1%8C%E6%A6%9C/2020%E5%B9%B406%E6%9C%8828%E6%97%A5/">
                        <span class="hidden-mobile">游戏排行榜/2020年06月28日</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

            
              <!-- Comments -->
              <div class="comments" id="comments">
                
                
  <div id="vcomments"></div>
  <script defer src="https://cdn.staticfile.org/valine/1.4.14/Valine.min.js" ></script>

  <script type="text/javascript">
    var oldLoadVa = window.onload;
    window.onload = function () {
      oldLoadVa && oldLoadVa();

      new Valine({
        el: "#vcomments",
        app_id: "gVAMLyDCRqLt5gl5jh7mkSsi-gzGzoHsz",
        app_key: "9hOzF8AiRn8aiWVVdrjq55Is",
        placeholder: "欢迎将您的想法告诉我",
        path: window.location.pathname,
        avatar: "retro",
        meta: ["nick","mail","link"],
        pageSize: "10",
        lang: "zh-CN",
        highlight: true,
        recordIP: false,
        serverURLs: "",
      });
    };
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://valine.js.org" target="_blank" rel="nofollow noopener noopener">comments
      powered by Valine.</a></noscript>


              </div>
            
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <!--<div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div>-->
    
  <div>
    
      <!-- 不蒜子统计PV -->
      
      <span id="busuanzi_container_site_pv" style="display: none">
      总访问量 <span id="busuanzi_value_site_pv"></span> 次
    </span>
    
    
      <!-- 不蒜子统计UV -->
      
      <span id="busuanzi_container_site_uv" style="display: none">
      总访客数 <span id="busuanzi_value_site_uv"></span> 人
    </span>
    
  </div>


    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/main.js" ></script>


  <script  src="/js/lazyload.js" ></script>



  
  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>





  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>




<!-- Plugins -->



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "提高处理excal效率的终极神器-VBA初步入门&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>


















</body>
</html>
